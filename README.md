# NGC7469_2nu
Supplementary material related to the paper "Two 100 TeV neutrinos coincident with the Seyfert galaxy NGC 7469"
This project is aimed to reproduce the results and the plots of the paper.

The project contains 4 folders:
- `src`, it contains all the programs necessary to reproduce the results and plots of the paper, in particular:
  - `statistical_test.py`, it reproduces the statistical tests producing the background distributions of the test statistic (ts) and calculating the ts value for the neutrino doublet IC220424A & IC230416A with NGC 7469. It saves the results in `data_results`;
  - `areas_ratio.py`, produces a figure about the ratio between the contour area of Millipede and SplineMPE (not in the published paper);
  - `coincidence_plots.py`, it reprocuces Figure 1, about the reconstructed directions of IC220424A and IC230416A by the GCN Notices and GCN Circulars and the position of NGC 7469;
  - `ts_dependence_on_flux.py`, it reproduces Figure 2, about the dependence of the test statistic on the intrinsic neutrino flux (a parameter of the Goodness-of-Fit test);
  - `plot_test_statistics.py`, to plot the background test statistic distributions generated by `statistical_test.py`, some of these plots are Figures 3, 5, and 6 in the paper;
  - `produce_sed.py`, to reproduce Figure 4 and 7, about the SEDs of NGC 7469 and NGC 1068 and the measured neutrino flux. It also estimates upper and lower limits for the neutrino flux of NGC 7469.
- `data`, it contains the various data needed by the programs in `src`, the Turin and Milliquas catalogs are downloaded when launched `statistical_test.py`. In particular, it contains:
  - `IC_Alerts_Table_Energies.csv`, all the data about the GCN Circulars for the neutrino alerts from 2019 until October 2023;
  - `IceCube_Gold_Bronze_Tracks.csv` [the IceCat-1 catalog of neutrino alerts](https://icecube.wisc.edu/news/research/2023/04/icecat-1-icecubes-first-event-catalog-of-neutrino-track-alerts/), necessary to calculate the probability distribution in case of neutrinos which have not originated from any source; 
  - `gcn_notices_gold_bronze.txt`, all the data about the GCN Notices for the neutrino alerts from 2019 until October 2023, the file consists of the source of the webpage https://gcn.gsfc.nasa.gov/amon_icecube_gold_bronze_events.html;
  - `NGC1068_SED_with_sources.txt`, the electromagnetic data for the SED of NGC 1068, with references;
  - `NGC7469_SED_with_sources.txt`, the electromagnetic data for the SED of NGC 7469, with references;
  - `Effa_all_streams_gold_bronze.txt`, the effective areas depending on declination and energy for realtime alerts, from [here](https://icecube.wisc.edu/news/research/2023/04/icecat-1-icecubes-first-event-catalog-of-neutrino-track-alerts/);
  - `pstracks_7yrs_diffsens.csv`, the diffential sensitivities of [this IceCube search](https://iopscience.iop.org/article/10.3847/1538-4357/835/2/151).
- `figures`, it contains all the figures produced by the programs in `src`, so all the figures in the paper in `png` and `pdf` format. It also contains the distribution of the background statistics for all the tests with Millipede and for the test with SplineMPE and the X-ray flux, these plots are not in the paper.
- `data_results`, it contains the numpy files produced by the program `statistical_test.py`, the data-file names for the test-statistic background distributions are structured as `test_statistic_reconstruction_catalog_weight.npy`, where `reconstruction` can be `splinempe` or `millipede`, `catalog` can be `turin` or `milliquas`, and `weight` can be `redshift` or `xray`. The single test-statistic value for IC220424A & IC230416A with NGC 7469 is stored in the files `test_statistic_reconstruction_catalog_weight_result.npy`;

### How to run the code
To run the code, it is necessary to go in the `src` folder and digit `python program.py`. It is important to start the programs from the `src` folder.
Regarding `statistical_test.py`, there are several possible inputs to produce different tests. All the possibilities are described in the following table.
| | Reconstruction | Catalog | Weight | Alternative hypothesis | Declination jitter |
| -- | -- | -- | -- | -- | -- |
| Identifier | `--reco` or `-r` | `--catalog` or `-c` | `--flux` or `-f` | `--alternative_hypothesis` or `-a` | `--declination-jitter` or `-d` |
| Possibilities | `splinempe` and `millipede` | `turin` and `milliquas` | `redshift`, `xray`, or `noweight`| `Background`, `Doublet`, `Population`, `Doublet-inj`, and `Singlet-inj` | Any `float` value or `None` |
| Default | `splinempe` | `turin` | `redshift` | `Background` | `None` |
| Description | Reconstruction for the realtime alerts | Catalog of sources for the test, a more detailed description about the catalogs is in the paper | Weight to use in the test statistic for the sources | Hypothesis for the generated test statistic distribution. A more detailed description is available further on in this header. | Width of the uniform distribution which will change the declination for the alerts in the scramble. |

### Alternative hypotheses
The code offers the possibility to generate the test statistic distribution under various hypotheses.
The default is the `Background` one, i.e., the hypothesis under which no neutrino originated from any source in the catalog.
The possible alternative hypotheses are:
- `Doublet`, the test statistic is calculated on a doublet injected on one source of the catalog randomly selected depending on the weight;
- `Population`, by assuming the flux in the signal distribution, neutrinos are randomly injected on the sources in the catalog following a Poissonian distribution. Most of the scrambles will have no neutrinos, some will have 1, and very rarely there will be a scramble with 2 neutrinos and in some cases even on the same source;
- `Doublet-inj`, in each scramble, a doublet is injected on one source of the catalog randomly selected depending on the weight;
- `Singlet-inj`, in each scramble, one neutrino is injected on one source of the catalog randomly selected depending on the weight.
